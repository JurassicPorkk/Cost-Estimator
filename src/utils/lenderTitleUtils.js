// GEORGIA Lender's Title Insurance Rate Matrix
export const georgiaLenderTitleRateMatrix = [
  [0.00485, 0.00453, 0.00422, 0.00390, 0.00358, 0.00327, 0.00295, 0.00263, 0.00232, 0.00200],
  [0.00442, 0.00504, 0.00566, 0.00628, 0.00690, 0.00752, 0.00814, 0.00876, 0.00938, 0.01000],
  [0.00428, 0.00455, 0.00482, 0.00509, 0.00536, 0.00562, 0.00589, 0.00616, 0.00643, 0.00670],
  [0.00421, 0.00430, 0.00439, 0.00447, 0.00456, 0.00465, 0.00474, 0.00482, 0.00491, 0.00500],
  [0.00417, 0.00425, 0.00432, 0.00440, 0.00447, 0.00455, 0.00462, 0.00470, 0.00477, 0.00485],
  [0.00409, 0.00417, 0.00426, 0.00434, 0.00443, 0.00451, 0.00460, 0.00468, 0.00477, 0.00485],
  [0.00403, 0.00412, 0.00421, 0.00430, 0.00439, 0.00449, 0.00458, 0.00467, 0.00476, 0.00485],
  [0.00399, 0.00409, 0.00418, 0.00428, 0.00437, 0.00447, 0.00456, 0.00466, 0.00475, 0.00485],
  [0.00396, 0.00406, 0.00416, 0.00426, 0.00436, 0.00445, 0.00455, 0.00465, 0.00475, 0.00485],
  [0.00396, 0.00406, 0.00416, 0.00426, 0.00436, 0.00445, 0.00455, 0.00465, 0.00475, 0.00485]
];

// ALABAMA Lender's Title Insurance Rate Matrix
export const alabamaLenderTitleRateMatrix = [
  [0.0025, 0.00361, 0.00472, 0.00583, 0.00694, 0.00806, 0.00917, 0.01028, 0.01139, 0.0125],
  [0.00225, 0.00275, 0.00325, 0.00375, 0.00425, 0.00475, 0.00525, 0.00575, 0.00575, 0.00625],
  [0.00216, 0.00239, 0.00262, 0.00285, 0.00308, 0.00331, 0.00354, 0.00377, 0.00396, 0.00416],
  [0.00212, 0.00223, 0.00234, 0.00245, 0.00256, 0.00267, 0.00278, 0.00289, 0.00300, 0.00312],
  [0.0021, 0.00213, 0.00217, 0.00220, 0.00223, 0.00227, 0.00230, 0.00233, 0.00237, 0.0025],
  [0.0024, 0.00241, 0.00243, 0.00244, 0.00246, 0.00247, 0.00249, 0.0025, 0.0025, 0.0025],
  [0.00192, 0.00200, 0.00208, 0.00216, 0.00224, 0.00232, 0.00240, 0.00248, 0.00249, 0.0025],
  [0.00187, 0.00196, 0.00204, 0.00213, 0.00221, 0.00230, 0.00238, 0.00247, 0.00248, 0.0025],
  [0.00183, 0.00192, 0.00202, 0.00211, 0.00220, 0.00230, 0.00239, 0.00248, 0.00249, 0.0025],
  [0.0018, 0.00189, 0.00198, 0.00207, 0.00217, 0.00226, 0.00235, 0.00244, 0.00247, 0.0025]
];

// Lender Title Rate Lookup Function
export function getLenderTitleRate(state, salesPrice, loanAmount) {
  const priceBands = [100000, 200000, 300000, 400000, 500000, 600000, 700000, 800000, 900000, 1000000];
  const ltvBands = [100, 90, 80, 70, 60, 50, 40, 30, 20, 0];
  const ltv = (loanAmount / salesPrice) * 100;

  let priceIndex = priceBands.findIndex(limit => salesPrice < limit);
  if (priceIndex === -1) priceIndex = 9;

  let ltvIndex = ltvBands.findIndex(threshold => ltv >= threshold);
  if (ltvIndex === -1) ltvIndex = 9;

  const normalizedState = state.toLowerCase();

  if (normalizedState === "georgia") {
    return georgiaLenderTitleRateMatrix[priceIndex][ltvIndex];
  } else if (normalizedState === "alabama") {
    return alabamaLenderTitleRateMatrix[priceIndex][ltvIndex];
  } else {
    return 0;
  }
}