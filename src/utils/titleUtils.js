// GEORGIA Title Insurance Rate Matrix
export const georgiaTitleRateMatrix = [
  [0.00375, 0.00407, 0.00438, 0.00470, 0.00502, 0.00533, 0.00565, 0.00597, 0.00628, 0.00660],
  [0.00265, 0.00303, 0.00341, 0.00379, 0.00417, 0.00455, 0.00493, 0.00531, 0.00569, 0.00607],
  [0.00228, 0.00268, 0.00308, 0.00349, 0.00389, 0.00429, 0.00469, 0.00510, 0.00550, 0.00590],
  [0.00210, 0.00251, 0.00292, 0.00334, 0.00375, 0.00416, 0.00457, 0.00499, 0.00540, 0.00581],
  [0.00199, 0.00240, 0.00281, 0.00322, 0.00363, 0.00403, 0.00444, 0.00485, 0.00526, 0.00567],
  [0.00179, 0.00219, 0.00259, 0.00299, 0.00339, 0.00379, 0.00419, 0.00459, 0.00499, 0.00539],
  [0.00165, 0.00204, 0.00244, 0.00283, 0.00323, 0.00362, 0.00402, 0.00441, 0.00481, 0.00520],
  [0.00154, 0.00193, 0.00232, 0.00271, 0.00310, 0.00349, 0.00388, 0.00427, 0.00466, 0.00505],
  [0.00146, 0.00185, 0.00223, 0.00262, 0.00300, 0.00339, 0.00377, 0.00416, 0.00454, 0.00493],
  [0.00147, 0.00184, 0.00222, 0.00259, 0.00297, 0.00334, 0.00372, 0.00409, 0.00447, 0.00484]
];

// ALABAMA Title Insurance Rate Matrix
export const alabamaTitleRateMatrix = [
  [0.00300, 0.00314, 0.00328, 0.00342, 0.00356, 0.00369, 0.00383, 0.00397, 0.00411, 0.00425],
  [0.00212, 0.00230, 0.00248, 0.00266, 0.00284, 0.00303, 0.00321, 0.00339, 0.00357, 0.00375],
  [0.00183, 0.00202, 0.00222, 0.00241, 0.00261, 0.00280, 0.00300, 0.00319, 0.00339, 0.00358],
  [0.00168, 0.00188, 0.00208, 0.00229, 0.00249, 0.00269, 0.00289, 0.00310, 0.00330, 0.00350],
  [0.00160, 0.00181, 0.00201, 0.00222, 0.00242, 0.00263, 0.00283, 0.00304, 0.00324, 0.00345],
  [0.00150, 0.00169, 0.00189, 0.00208, 0.00228, 0.00247, 0.00267, 0.00286, 0.00306, 0.00325],
  [0.00142, 0.00161, 0.00179, 0.00198, 0.00217, 0.00235, 0.00254, 0.00273, 0.00291, 0.00310],
  [0.00137, 0.00155, 0.00173, 0.00191, 0.00209, 0.00228, 0.00246, 0.00264, 0.00282, 0.00300],
  [0.00133, 0.00151, 0.00168, 0.00186, 0.00203, 0.00221, 0.00238, 0.00256, 0.00273, 0.00291],
  [0.00130, 0.00147, 0.00164, 0.00182, 0.00199, 0.00216, 0.00233, 0.00251, 0.00268, 0.00285]
];

export function getOwnerTitleRate(state, salesPrice, loanAmount) {
  const priceBands = [100000, 200000, 300000, 400000, 500000, 600000, 700000, 800000, 900000, 1000000];
  const ltvBands = [100, 90, 80, 70, 60, 50, 40, 30, 20, 0];
  const ltv = (loanAmount / salesPrice) * 100;

  let priceIndex = priceBands.findIndex(limit => salesPrice < limit);
  if (priceIndex === -1) priceIndex = 9;

  let ltvIndex = ltvBands.findIndex(threshold => ltv >= threshold);
  if (ltvIndex === -1) ltvIndex = 9;

  const normalizedState = state.toLowerCase();

  if (normalizedState === "georgia") {
    return georgiaTitleRateMatrix[priceIndex][ltvIndex];
  } else if (normalizedState === "alabama") {
    return alabamaTitleRateMatrix[priceIndex][ltvIndex];
  } else {
    return 0;
  }
}